% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/train_gnn.R
\name{train_gnn}
\alias{train_gnn}
\title{Train and Evaluate the Gated Neural Network}
\usage{
train_gnn(
  prepared_data,
  hyper_grid,
  num_repeats = 20,
  epochs = 300,
  output_dir = "outputs",
  run_tuning = TRUE,
  best_params = NULL
)
}
\arguments{
\item{prepared_data}{A list object from the \code{prepare_data()} function.}

\item{hyper_grid}{A dataframe of hyperparameters to tune. Must include columns:
\code{lr}, \code{hidden_dim}, \code{dropout_rate}, \code{lambda}, \code{temperature}.}

\item{num_repeats}{Integer, the number of repeated train/test splits for evaluation.}

\item{epochs}{Integer, the number of training epochs per run.}

\item{output_dir}{A string path to a directory where results will be saved.}

\item{run_tuning}{Boolean, whether to run the hyperparameter tuning step.}

\item{best_params}{A list containing the best parameters (\code{lr}, \code{hidden_dim}, \code{dropout}, \code{lambda}, \code{temperature}) if \code{run_tuning = FALSE}.}
}
\value{
A list containing detailed results: \code{final_results}, \code{gate_weights},
\code{expert_weights}, \code{performance_summary}, \code{aif360_data}, and \code{tuning_results}.
}
\description{
This function performs a complete training and evaluation run, including
an optional hyperparameter tuning step and a final evaluation run.
}
